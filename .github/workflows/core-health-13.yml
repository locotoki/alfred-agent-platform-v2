name: core-health-13
on: pull_request
jobs:
  core-health-13:
    name: core-health-13
    runs-on: ubuntu-22.04
    steps:
      - uses: actions/checkout@v4
      - name: Spin 13-service slice
        env:
          CI: true
        run: |
          docker compose -p alfred -f docker-compose.ci-core.yml up -d    # only 13 core services
      - name: Wait & check probes
        env:
          COMPOSE_FILE: docker-compose.ci-core.yml
          COMPOSE_PROJECT: alfred
        run: |
          sleep 360    # 6 minutes for Llama model download and all services to stabilize
          ./scripts/check-core-health.sh